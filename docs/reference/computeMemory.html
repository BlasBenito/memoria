<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Quantifies ecological memory with Random Forest. — computeMemory • memoria</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Quantifies ecological memory with Random Forest. — computeMemory" />

<meta property="og:description" content="Takes the oputput of prepareLaggedData to fit the following model with Random Forest:
\(p_{t} = p_{t-1} +...+ p_{t-n} + d_{t} + d_{t-1} +...+ d_{t-n} + r\)
where:

\(d\) is a driver (several drivers can be added).
\(t\) is the time of any given value of the response p.
\(t-1\) is the lag number 1 (in time units).
\(p_{t-1} +...+ p_{t-n}\)  represents the endogenous component of ecological memory.
\(d_{t-1} +...+ d_{t-n}\)  represents the exogenous component of ecological memory.
\(d_{t}\) represents the concurrent effect of the driver over the response.
\(r\) represents a column of random values, used to test the significance of the variable importance scores returned by Random Forest.
" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">memoria</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/using_memoria.html">virtualPollen</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Quantifies ecological memory with Random Forest.</h1>
    
    <div class="hidden name"><code>computeMemory.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Takes the oputput of <code><a href='prepareLaggedData.html'>prepareLaggedData</a></code> to fit the following model with Random Forest:</p>
<p>\(p_{t} = p_{t-1} +...+ p_{t-n} + d_{t} + d_{t-1} +...+ d_{t-n} + r\)</p>
<p>where:</p>
<ul>
<li><p>\(d\) is a driver (several drivers can be added).</p></li>
<li><p>\(t\) is the time of any given value of the response <em>p</em>.</p></li>
<li><p>\(t-1\) is the lag number 1 (in time units).</p></li>
<li><p>\(p_{t-1} +...+ p_{t-n}\)  represents the endogenous component of ecological memory.</p></li>
<li><p>\(d_{t-1} +...+ d_{t-n}\)  represents the exogenous component of ecological memory.</p></li>
<li><p>\(d_{t}\) represents the concurrent effect of the driver over the response.</p></li>
<li><p>\(r\) represents a column of random values, used to test the significance of the variable importance scores returned by Random Forest.</p></li>
</ul>
    
    </div>

    <pre class="usage"><span class='fu'>computeMemory</span>(
 <span class='kw'>lagged.data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
 <span class='kw'>drivers</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
 <span class='kw'>response</span> <span class='kw'>=</span> <span class='st'>"Response"</span>,
 <span class='kw'>add.random</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>random.mode</span> <span class='kw'>=</span> <span class='st'>"autocorrelated"</span>,
 <span class='kw'>repetitions</span> <span class='kw'>=</span> <span class='fl'>10</span>,
 <span class='kw'>subset.response</span> <span class='kw'>=</span> <span class='st'>"none"</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>lagged.data</th>
      <td><p>a lagged dataset resulting from <code><a href='prepareLaggedData.html'>prepareLaggedData</a></code>. See <code>laggedSimData</code> as example.</p></td>
    </tr>
    <tr>
      <th>drivers</th>
      <td><p>a string or vector of strings with variables to be used as predictors in the model (i.e. c("Suitability", "Driver.A"))</p></td>
    </tr>
    <tr>
      <th>response</th>
      <td><p>character string, name of the response variable (typically, "Response_0").</p></td>
    </tr>
    <tr>
      <th>add.random</th>
      <td><p>if TRUE, adds a random term to the model, useful to assess the significance of the variable importance scores.</p></td>
    </tr>
    <tr>
      <th>random.mode</th>
      <td><p>either "white.noise" or "autocorrelated". See details.</p></td>
    </tr>
    <tr>
      <th>repetitions</th>
      <td><p>integer, number of random forest models to fit.</p></td>
    </tr>
    <tr>
      <th>subset.response</th>
      <td><p>character string with values "up", "down" or "none", triggers the subsetting of the input dataset. "up" only models memory on cases where the response's trend is positive, "down" selectes cases with negative trends, and "none" selects all cases.</p></td>
    </tr>
    <tr>
      <th>min.node.size</th>
      <td><p>integer, argument of the <a href='https://www.rdocumentation.org/packages/ranger/topics/ranger'>ranger</a> function. Minimal number of samples to be allocated in a terminal node. Default is 5.</p></td>
    </tr>
    <tr>
      <th>num.trees</th>
      <td><p>integer, argument of the <a href='https://www.rdocumentation.org/packages/ranger/topics/ranger'>ranger</a> function. Number of regression trees to be fitted (size of the forest). Default is 2000.</p></td>
    </tr>
    <tr>
      <th>mtry</th>
      <td><p>integer, argument of the <a href='https://www.rdocumentation.org/packages/ranger/topics/ranger'>ranger</a> function. Number of variables to possibly split at in each node. Default is 2.</p></td>
    </tr>
    <tr>
      <th>drivers</th>
      <td><p>a character string or vector of character strings with variables to be used as predictors in the model (i.e. c("Suitability", "Driver.A")). <strong>Important:</strong> <code>drivers</code> names must not have the character "_".</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with 4 slots:</p><ul>
<li><p><code>memory</code> dataframe with five columns:</p><ul>
<li><p><code>Variable</code> character, names and lags of the different variables used to model ecological memory.</p></li>
<li><p><code>median</code> numeric, median importance across <code>repetitions</code> of the given <code>Variable</code> according to Random Forest.</p></li>
<li><p><code>sd</code> numeric, standard deviation of the importance values of the given <code>Variable</code> across <code>repetitions</code>.</p></li>
<li><p><code>min</code> and <code>max</code> numeric, percentiles 0.05 and 0.95 of importance values of the given <code>Variable</code> across <code>repetitions</code>.</p></li>
</ul></li>
<li><p><code>R2</code> vector, values of pseudo R-squared value obtained for the Random Forest model fitted on each repetition. Pseudo R-squared is the Pearson correlation beteween the observed and predicted data.</p></li>
<li><p><code>prediction</code> dataframe, with the same columns as the dataframe in the slot <code>memory</code>, with the median and confidence intervals of the predictions of all random forest models fitted.</p></li>
<li><p><code>multicollinearity</code> multicollinearity analysis on the input data performed with <a href='https://www.rdocumentation.org/packages/HH/topics/vif'>vif</a>. A vif value higher than 5 indicates that the given variable is highly correlated with other variables.</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function uses the <a href='https://www.rdocumentation.org/packages/ranger/topics/ranger'>ranger</a> package to fit Random Forest models. It fits the model explained above as many times as defined in the argument <code>repetitions</code>. To test the statistical significance of the variable importance scores returned by random forest, on each repetition the model is fitted with a different <code>r</code> (random) term. If <code>random.mode</code> equals "autocorrelated", the random term will have a temporal autocorrelation, and if it equals "white.noise", it will be a pseudo-random sequence of numbers generated with <code><a href='https://www.rdocumentation.org/packages/stats/topics/Normal'>rnorm</a></code>, with no temporal autocorrelation. The importance of the random sequence (as computed by random forest) is stored for each model run, and used as a benchmark to assess the importance of the other predictors used in the models. Importance values of other predictors that are above the median of the importance of the random term should be interpreted as non-random, and therefore, significant.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='plotMemory.html'>plotMemory</a></code>, <code><a href='extractMemoryFeatures.html'>extractMemoryFeatures</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#loading data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>palaeodataLagged</span>)

<span class='no'>memory.output</span> <span class='kw'>&lt;-</span> <span class='fu'>computeMemory</span>(
 <span class='kw'>lagged.data</span> <span class='kw'>=</span> <span class='no'>palaeodataLagged</span>,
 <span class='kw'>drivers</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"climate.temperatureAverage"</span>, <span class='st'>"climate.rainfallAverage"</span>),
 <span class='kw'>response</span> <span class='kw'>=</span> <span class='st'>"Response"</span>,
 <span class='kw'>add.random</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
 <span class='kw'>random.mode</span> <span class='kw'>=</span> <span class='st'>"autocorrelated"</span>,
 <span class='kw'>repetitions</span> <span class='kw'>=</span> <span class='fl'>10</span>,
 <span class='kw'>subset.response</span> <span class='kw'>=</span> <span class='st'>"none"</span>
)

<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str</a></span>(<span class='no'>memory.output</span>)</div><div class='output co'>#&gt; List of 4
#&gt;  $ memory           :'data.frame':	23 obs. of  6 variables:
#&gt;   ..$ median  : num [1:23] 64 51.2 40.7 36 42.8 ...
#&gt;   ..$ sd      : num [1:23] 0.532 0.597 0.863 0.998 0.711 ...
#&gt;   ..$ min     : num [1:23] 63.2 50.4 40.5 34.3 42.2 ...
#&gt;   ..$ max     : num [1:23] 64.6 52 42.6 37.1 44.1 ...
#&gt;   ..$ Variable: Factor w/ 4 levels "Response","climate.temperatureAverage",..: 1 1 1 1 1 2 2 2 2 2 ...
#&gt;   ..$ Lag     : num [1:23] 0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 ...
#&gt;  $ R2               : num [1:10] 0.988 0.988 0.988 0.988 0.989 ...
#&gt;  $ prediction       :'data.frame':	3988 obs. of  4 variables:
#&gt;   ..$ median: num [1:3988] 4.72 5.51 7.63 11.09 13.53 ...
#&gt;   ..$ sd    : num [1:3988] 0.139 0.131 0.109 0.116 0.153 ...
#&gt;   ..$ min   : num [1:3988] 4.48 5.34 7.44 10.94 13.26 ...
#&gt;   ..$ max   : num [1:3988] 4.83 5.73 7.69 11.25 13.65 ...
#&gt;  $ multicollinearity:'data.frame':	17 obs. of  2 variables:
#&gt;   ..$ variable: Factor w/ 17 levels "climate.rainfallAverage_0",..: 13 14 15 16 17 7 8 9 10 11 ...
#&gt;   ..$ vif     : num [1:17] 27.5 75 77.8 75 27.4 ...</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/str'>str</a></span>(<span class='no'>memory.output</span>$<span class='no'>memory</span>)</div><div class='output co'>#&gt; 'data.frame':	23 obs. of  6 variables:
#&gt;  $ median  : num  64 51.2 40.7 36 42.8 ...
#&gt;  $ sd      : num  0.532 0.597 0.863 0.998 0.711 ...
#&gt;  $ min     : num  63.2 50.4 40.5 34.3 42.2 ...
#&gt;  $ max     : num  64.6 52 42.6 37.1 44.1 ...
#&gt;  $ Variable: Factor w/ 4 levels "Response","climate.temperatureAverage",..: 1 1 1 1 1 2 2 2 2 2 ...
#&gt;  $ Lag     : num  0.2 0.4 0.6 0.8 1 0 0.2 0.4 0.6 0.8 ...</div><div class='input'>
<span class='co'>#plotting output</span>
<span class='fu'><a href='plotMemory.html'>plotMemory</a></span>(<span class='kw'>memory.output</span> <span class='kw'>=</span> <span class='no'>memory.output</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: ggplot2</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘cowplot’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:ggplot2’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    ggsave</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: viridisLite</span></div><div class='img'><img src='computeMemory-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Blas M. Benito  &lt;blasbenito@gmail.com&gt;</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

