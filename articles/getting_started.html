<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started • memoria</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<link rel="stylesheet" href="extra.css">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">memoria</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/getting_started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/memoria_and_virtualPollen.html">memoria and virtualPollen</a></li>
    <li><a class="dropdown-item" href="../articles/download_history.html">Download History</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started</h1>
            
      

      <div class="d-none name"><code>getting_started.Rmd</code></div>
    </div>

    
    
<p>This article walks through the complete <code>memoria</code> workflow
for quantifying ecological memory in time series data consisting of at
least one response and one predictor.</p>
<div class="section level2">
<h2 id="ecological-memory">Ecological Memory<a class="anchor" aria-label="anchor" href="#ecological-memory"></a>
</h2>
<p>The package <code>memoria</code> helps quantify how past and
concurrent events shape the state of a system. This concept is
summarized in the figure below:</p>
<p><img src="ecological_memory.png" alt="Ecological Memory"> The blue
and green curves represent the values of a biotic response
<code>y</code> and a driver <code>x</code> over time. The vertical line
<code>T</code> represents the <em>current</em> time, while
<code>T - lag</code> represents a previous time. The arrows represent
<em>influence</em>, as follows:</p>
<ul>
<li>
<strong>Endogenous memory</strong>: is the effect of past
<code>y</code> on present <code>y</code>.</li>
<li>
<strong>Exogenous memory</strong>: is the effect of past
<code>x</code> on present <code>y</code>.</li>
<li>
<strong>Concurrent effect</strong>: is the effect of present
<code>x</code> on present <code>y</code>.</li>
</ul>
<p>To assess these effects, <code>memoria</code> generates the lagged
data and trains the model</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>T</mi></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>…</mi><mo>+</mo><msub><mi>y</mi><mrow><mi>T</mi><mo>−</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>x</mi><mi>T</mi></msub><mo>+</mo><msub><mi>x</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>…</mi><mo>+</mo><msub><mi>x</mi><mrow><mi>T</mi><mo>−</mo><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>r</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">y_{T} = y_{T-1} + \ldots + y_{T-n} + x_{T} + x_{T-1} + \ldots + x_{T-n} + r_{T}</annotation></semantics></math></p>
<p>Where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
are the response and the driver.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the “current” time, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">T-1</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>−</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">T-n</annotation></semantics></math>,
are the time lags.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>…</mi><mo>+</mo><msub><mi>y</mi><mrow><mi>T</mi><mo>−</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{T-1} + \ldots + y_{T-n}</annotation></semantics></math>
represents the <strong>endogenous memory</strong> across lags.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>…</mi><mo>+</mo><msub><mi>x</mi><mrow><mi>T</mi><mo>−</mo><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{T-1} + \ldots + x_{T-n}</annotation></semantics></math>
represents the <strong>exogenous memory</strong> across lags.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>T</mi></msub><annotation encoding="application/x-tex">x_{T}</annotation></semantics></math>
represents the <strong>concurrent effect</strong>.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mi>T</mi></msub><annotation encoding="application/x-tex">r_{T}</annotation></semantics></math>
is a random term used to assess statistical significance.</li>
</ul>
<p>The ecological memory pattern is quantified using <strong>permutation
importance</strong> from Random Forest models. For each predictor, the
algorithm shuffles its values and measures the decrease in predictive
accuracy. Larger decreases indicate stronger influence on the
response.</p>
<p>To visualize ecological memory, the package <code>memoria</code>
plots permutation importance scores across time lags.</p>
<div class="float">
<img src="memory_plot.png" alt="Ecological Memory"><div class="figcaption">Ecological Memory</div>
</div>
<p>Where:</p>
<ul>
<li>
<code>a</code>: strength of the concurrent effect (highlighted by a
grey box).</li>
<li>
<code>b</code> and <code>c</code>: strength of the exogenous and
endogenous memory.</li>
<li>
<code>d</code> and <code>e</code>: length of the exogenous and
endogenous memory.</li>
<li>
<code>f</code> and <code>g</code>: dominance across lags of the
endogenous and exogenous memory.</li>
</ul>
<p>The following sections demonstrate how to implement this workflow in
R using the <code>memoria</code> package.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blasbenito.github.io/memoria/">memoria</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://blasbenito.github.io/distantia/" class="external-link">distantia</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>The typical workflow involves time series with one response variable
and one or several drivers.</p>
<p>The package <code>memoria</code> has two example datasets, one with
responses and one with drivers:</p>
<ul>
<li>
<strong>pollen</strong>: irregular time series with 639 samples and
four pollen types (Pinus, Quercus, Poaceae, Artemisia).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pollen</span>, package <span class="op">=</span> <span class="st">"memoria"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pollen</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">distantia</span><span class="fu">::</span><span class="fu"><a href="https://blasbenito.github.io/distantia/reference/tsl_initialize.html" class="external-link">tsl_init</a></span><span class="op">(</span></span>
<span>    time_column <span class="op">=</span> <span class="st">"age"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">distantia</span><span class="fu">::</span><span class="fu"><a href="https://blasbenito.github.io/distantia/reference/tsl_plot.html" class="external-link">tsl_plot</a></span><span class="op">(</span></span>
<span>    ylim <span class="op">=</span> <span class="st">"relative"</span>,</span>
<span>    guide <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-1-1.png" class="r-plt" alt="" width="100%"></p>
<ul>
<li>
<strong>climate</strong>: regular time series with 800 samples taken
every 1000 years, with climate variables (temperature, rainfall,
etc.)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">climate</span>, package <span class="op">=</span> <span class="st">"memoria"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">climate</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">distantia</span><span class="fu">::</span><span class="fu"><a href="https://blasbenito.github.io/distantia/reference/tsl_initialize.html" class="external-link">tsl_init</a></span><span class="op">(</span></span>
<span>    time_column <span class="op">=</span> <span class="st">"age"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">distantia</span><span class="fu">::</span><span class="fu"><a href="https://blasbenito.github.io/distantia/reference/tsl_plot.html" class="external-link">tsl_plot</a></span><span class="op">(</span></span>
<span>    ylim <span class="op">=</span> <span class="st">"relative"</span>,</span>
<span>    guide <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    line_color <span class="op">=</span> <span class="st">"blue4"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" alt="" width="100%"></p>
<div class="section level3">
<h3 id="align-datasets">Align Datasets<a class="anchor" aria-label="anchor" href="#align-datasets"></a>
</h3>
<p>The package <code>memoria</code> requires the input time series to be
regular, but <code>pollen</code> is irregular, with a range of time
intervals between 0.32 and 6.475.</p>
<p>To homogenize both datasets, below we use linear interpolation with
time to align <code>pollen</code> with <code>climate</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">memoria</span><span class="fu">::</span><span class="fu"><a href="../reference/alignTimeSeries.html">alignTimeSeries</a></span><span class="op">(</span></span>
<span>  datasets.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    pollen <span class="op">=</span> <span class="va">pollen</span>,</span>
<span>    climate <span class="op">=</span> <span class="va">climate</span></span>
<span>  <span class="op">)</span>,</span>
<span>  time.column <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  interpolation.interval <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 799</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="co">#1000 years</span></span>
<span><span class="co">#&gt; [1] 1 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "age"                             "pollen.pinus"                   </span></span>
<span><span class="co">#&gt;  [3] "pollen.quercus"                  "pollen.poaceae"                 </span></span>
<span><span class="co">#&gt;  [5] "pollen.artemisia"                "climate.temperatureAverage"     </span></span>
<span><span class="co">#&gt;  [7] "climate.rainfallAverage"         "climate.temperatureWarmestMonth"</span></span>
<span><span class="co">#&gt;  [9] "climate.temperatureColdestMonth" "climate.oxigenIsotope"</span></span></code></pre></div>
<p>Now that the responses and the drivers are at the same resolution, we
just need to select the data we want to play with.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="va">age</span>,</span>
<span>    quercus <span class="op">=</span> <span class="va">pollen.quercus</span>,</span>
<span>    rain <span class="op">=</span> <span class="va">climate.rainfallAverage</span>,</span>
<span>    temp <span class="op">=</span> <span class="va">climate.temperatureAverage</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-lagged-data">Create lagged data<a class="anchor" aria-label="anchor" href="#create-lagged-data"></a>
</h3>
<p>The <code><a href="../reference/lagTimeSeries.html">lagTimeSeries()</a></code> function organizes data into the lag
structure required by the model. Each sample of the response is aligned
with antecedent values of itself and the drivers. In this case we use
lags 1 to 10, which correspond with 1000 to 10000 years.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quercus_lags</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lagTimeSeries.html">lagTimeSeries</a></span><span class="op">(</span></span>
<span>  input.data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  response <span class="op">=</span> <span class="st">"quercus"</span>,</span>
<span>  drivers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rain"</span>, <span class="st">"temp"</span><span class="op">)</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  oldest.sample <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  lags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Note on <code>oldest.sample</code>:</strong> Set to
<code>"last"</code> when the oldest sample is at the bottom of the
dataframe (typical palaeoecological convention). Set to
<code>"first"</code> if the oldest sample is at the top.</p>
<p>The output columns follow a naming convention:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">quercus_lags</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 789</span></span>
<span><span class="co">#&gt; Columns: 34</span></span>
<span><span class="co">#&gt; $ quercus__0  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 95.5869512<span style="color: #949494;">, </span>134.9473077<span style="color: #949494;">, </span>135.5032469<span style="color: #949494;">, </span>102.7573460<span style="color: #949494;">, </span>78.5362…</span></span>
<span><span class="co">#&gt; $ quercus__1  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 134.9473077<span style="color: #949494;">, </span>135.5032469<span style="color: #949494;">, </span>102.7573460<span style="color: #949494;">, </span>78.5362180<span style="color: #949494;">, </span>144.577…</span></span>
<span><span class="co">#&gt; $ quercus__2  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 135.5032469<span style="color: #949494;">, </span>102.7573460<span style="color: #949494;">, </span>78.5362180<span style="color: #949494;">, </span>144.5770506<span style="color: #949494;">, </span>130.868…</span></span>
<span><span class="co">#&gt; $ quercus__3  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 102.7573460<span style="color: #949494;">, </span>78.5362180<span style="color: #949494;">, </span>144.5770506<span style="color: #949494;">, </span>130.8689767<span style="color: #949494;">, </span>107.072…</span></span>
<span><span class="co">#&gt; $ quercus__4  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 78.5362180<span style="color: #949494;">, </span>144.5770506<span style="color: #949494;">, </span>130.8689767<span style="color: #949494;">, </span>107.0723299<span style="color: #949494;">, </span>84.5673…</span></span>
<span><span class="co">#&gt; $ quercus__5  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 144.5770506<span style="color: #949494;">, </span>130.8689767<span style="color: #949494;">, </span>107.0723299<span style="color: #949494;">, </span>84.5673993<span style="color: #949494;">, </span>59.7365…</span></span>
<span><span class="co">#&gt; $ quercus__6  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 130.8689767<span style="color: #949494;">, </span>107.0723299<span style="color: #949494;">, </span>84.5673993<span style="color: #949494;">, </span>59.7365964<span style="color: #949494;">, </span>82.09479…</span></span>
<span><span class="co">#&gt; $ quercus__7  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 107.0723299<span style="color: #949494;">, </span>84.5673993<span style="color: #949494;">, </span>59.7365964<span style="color: #949494;">, </span>82.0947989<span style="color: #949494;">, </span>37.212402…</span></span>
<span><span class="co">#&gt; $ quercus__8  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 84.5673993<span style="color: #949494;">, </span>59.7365964<span style="color: #949494;">, </span>82.0947989<span style="color: #949494;">, </span>37.2124029<span style="color: #949494;">, </span>0.0000000<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ quercus__9  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 59.7365964<span style="color: #949494;">, </span>82.0947989<span style="color: #949494;">, </span>37.2124029<span style="color: #949494;">, </span>0.0000000<span style="color: #949494;">, </span>0.0000000<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ quercus__10 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 82.0947989<span style="color: #949494;">, </span>37.2124029<span style="color: #949494;">, </span>0.0000000<span style="color: #949494;">, </span>0.0000000<span style="color: #949494;">, </span>1.0420467<span style="color: #949494;">, </span>0…</span></span>
<span><span class="co">#&gt; $ rain__0     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.570000<span style="color: #949494;">, </span>1.569424<span style="color: #949494;">, </span>1.561583<span style="color: #949494;">, </span>1.551496<span style="color: #949494;">, </span>1.540789<span style="color: #949494;">, </span>1.532796…</span></span>
<span><span class="co">#&gt; $ rain__1     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.569424<span style="color: #949494;">, </span>1.561583<span style="color: #949494;">, </span>1.551496<span style="color: #949494;">, </span>1.540789<span style="color: #949494;">, </span>1.532796<span style="color: #949494;">, </span>1.525082…</span></span>
<span><span class="co">#&gt; $ rain__2     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.561583<span style="color: #949494;">, </span>1.551496<span style="color: #949494;">, </span>1.540789<span style="color: #949494;">, </span>1.532796<span style="color: #949494;">, </span>1.525082<span style="color: #949494;">, </span>1.521579…</span></span>
<span><span class="co">#&gt; $ rain__3     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.551496<span style="color: #949494;">, </span>1.540789<span style="color: #949494;">, </span>1.532796<span style="color: #949494;">, </span>1.525082<span style="color: #949494;">, </span>1.521579<span style="color: #949494;">, </span>1.524918…</span></span>
<span><span class="co">#&gt; $ rain__4     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.540789<span style="color: #949494;">, </span>1.532796<span style="color: #949494;">, </span>1.525082<span style="color: #949494;">, </span>1.521579<span style="color: #949494;">, </span>1.524918<span style="color: #949494;">, </span>1.524046…</span></span>
<span><span class="co">#&gt; $ rain__5     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.532796<span style="color: #949494;">, </span>1.525082<span style="color: #949494;">, </span>1.521579<span style="color: #949494;">, </span>1.524918<span style="color: #949494;">, </span>1.524046<span style="color: #949494;">, </span>1.509918…</span></span>
<span><span class="co">#&gt; $ rain__6     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.525082<span style="color: #949494;">, </span>1.521579<span style="color: #949494;">, </span>1.524918<span style="color: #949494;">, </span>1.524046<span style="color: #949494;">, </span>1.509918<span style="color: #949494;">, </span>1.490164…</span></span>
<span><span class="co">#&gt; $ rain__7     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.521579<span style="color: #949494;">, </span>1.524918<span style="color: #949494;">, </span>1.524046<span style="color: #949494;">, </span>1.509918<span style="color: #949494;">, </span>1.490164<span style="color: #949494;">, </span>1.479539…</span></span>
<span><span class="co">#&gt; $ rain__8     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.524918<span style="color: #949494;">, </span>1.524046<span style="color: #949494;">, </span>1.509918<span style="color: #949494;">, </span>1.490164<span style="color: #949494;">, </span>1.479539<span style="color: #949494;">, </span>1.485871…</span></span>
<span><span class="co">#&gt; $ rain__9     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.524046<span style="color: #949494;">, </span>1.509918<span style="color: #949494;">, </span>1.490164<span style="color: #949494;">, </span>1.479539<span style="color: #949494;">, </span>1.485871<span style="color: #949494;">, </span>1.503371…</span></span>
<span><span class="co">#&gt; $ rain__10    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.509918<span style="color: #949494;">, </span>1.490164<span style="color: #949494;">, </span>1.479539<span style="color: #949494;">, </span>1.485871<span style="color: #949494;">, </span>1.503371<span style="color: #949494;">, </span>1.504261…</span></span>
<span><span class="co">#&gt; $ temp__0     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.082412<span style="color: #949494;">, </span>14.003592<span style="color: #949494;">, </span>13.963610<span style="color: #949494;">, </span>13.962222<span style="color: #949494;">, </span>13.994756<span style="color: #949494;">, </span>14.…</span></span>
<span><span class="co">#&gt; $ temp__1     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.003592<span style="color: #949494;">, </span>13.963610<span style="color: #949494;">, </span>13.962222<span style="color: #949494;">, </span>13.994756<span style="color: #949494;">, </span>14.074843<span style="color: #949494;">, </span>14.…</span></span>
<span><span class="co">#&gt; $ temp__2     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.963610<span style="color: #949494;">, </span>13.962222<span style="color: #949494;">, </span>13.994756<span style="color: #949494;">, </span>14.074843<span style="color: #949494;">, </span>14.159573<span style="color: #949494;">, </span>14.…</span></span>
<span><span class="co">#&gt; $ temp__3     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.962222<span style="color: #949494;">, </span>13.994756<span style="color: #949494;">, </span>14.074843<span style="color: #949494;">, </span>14.159573<span style="color: #949494;">, </span>14.214738<span style="color: #949494;">, </span>14.…</span></span>
<span><span class="co">#&gt; $ temp__4     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.994756<span style="color: #949494;">, </span>14.074843<span style="color: #949494;">, </span>14.159573<span style="color: #949494;">, </span>14.214738<span style="color: #949494;">, </span>14.203480<span style="color: #949494;">, </span>14.…</span></span>
<span><span class="co">#&gt; $ temp__5     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.074843<span style="color: #949494;">, </span>14.159573<span style="color: #949494;">, </span>14.214738<span style="color: #949494;">, </span>14.203480<span style="color: #949494;">, </span>14.072493<span style="color: #949494;">, </span>13.…</span></span>
<span><span class="co">#&gt; $ temp__6     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.159573<span style="color: #949494;">, </span>14.214738<span style="color: #949494;">, </span>14.203480<span style="color: #949494;">, </span>14.072493<span style="color: #949494;">, </span>13.798291<span style="color: #949494;">, </span>13.…</span></span>
<span><span class="co">#&gt; $ temp__7     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.214738<span style="color: #949494;">, </span>14.203480<span style="color: #949494;">, </span>14.072493<span style="color: #949494;">, </span>13.798291<span style="color: #949494;">, </span>13.514943<span style="color: #949494;">, </span>13.…</span></span>
<span><span class="co">#&gt; $ temp__8     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.203480<span style="color: #949494;">, </span>14.072493<span style="color: #949494;">, </span>13.798291<span style="color: #949494;">, </span>13.514943<span style="color: #949494;">, </span>13.153375<span style="color: #949494;">, </span>12.…</span></span>
<span><span class="co">#&gt; $ temp__9     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.072493<span style="color: #949494;">, </span>13.798291<span style="color: #949494;">, </span>13.514943<span style="color: #949494;">, </span>13.153375<span style="color: #949494;">, </span>12.558464<span style="color: #949494;">, </span>11.…</span></span>
<span><span class="co">#&gt; $ temp__10    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.798291<span style="color: #949494;">, </span>13.514943<span style="color: #949494;">, </span>13.153375<span style="color: #949494;">, </span>12.558464<span style="color: #949494;">, </span>11.686879<span style="color: #949494;">, </span>10.…</span></span>
<span><span class="co">#&gt; $ time        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5<span style="color: #949494;">, </span>1.5<span style="color: #949494;">, </span>2.5<span style="color: #949494;">, </span>3.5<span style="color: #949494;">, </span>4.5<span style="color: #949494;">, </span>5.5<span style="color: #949494;">, </span>6.5<span style="color: #949494;">, </span>7.5<span style="color: #949494;">, </span>8.5<span style="color: #949494;">, </span>9.5<span style="color: #949494;">, </span>10.5<span style="color: #949494;">, </span>11…</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quercus_lags</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">quercus__0</span>,</span>
<span>    <span class="va">quercus__5</span>,</span>
<span>    <span class="va">quercus__10</span>,</span>
<span>    <span class="va">time</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">time</span> <span class="op">&lt;=</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">distantia</span><span class="fu">::</span><span class="fu"><a href="https://blasbenito.github.io/distantia/reference/tsl_initialize.html" class="external-link">tsl_init</a></span><span class="op">(</span></span>
<span>    time_column <span class="op">=</span> <span class="st">"time"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">distantia</span><span class="fu">::</span><span class="fu"><a href="https://blasbenito.github.io/distantia/reference/tsl_plot.html" class="external-link">tsl_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="" width="100%"></p>
</div>
<div class="section level3">
<h3 id="ecological-memory-analysis">Ecological Memory Analysis<a class="anchor" aria-label="anchor" href="#ecological-memory-analysis"></a>
</h3>
<p>The <code><a href="../reference/computeMemory.html">computeMemory()</a></code> function fits Random Forest models
on the lagged data. It measures variable importance using permutation,
which is robust to multicollinearity and temporal autocorrelation.</p>
<p>Two benchmark modes are available for significance testing:</p>
<ul>
<li>
<code>"white.noise"</code>: Random values without temporal structure
(faster)</li>
<li>
<code>"autocorrelated"</code>: Random walk with temporal structure
(more conservative, <strong>recommended</strong>)</li>
</ul>
<p>The model runs multiple times (<code>repetitions</code>),
regenerating the random term each time, then computes percentiles of
importance scores.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">quercus_memory</span> <span class="op">&lt;-</span> <span class="fu">memoria</span><span class="fu">::</span><span class="fu"><a href="../reference/computeMemory.html">computeMemory</a></span><span class="op">(</span></span>
<span>  lagged.data <span class="op">=</span> <span class="va">quercus_lags</span>,</span>
<span>  random.mode <span class="op">=</span> <span class="st">"autocorrelated"</span>,</span>
<span>  repetitions <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can visualize the results with <code><a href="../reference/plotMemory.html">plotMemory()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">memoria</span><span class="fu">::</span><span class="fu"><a href="../reference/plotMemory.html">plotMemory</a></span><span class="op">(</span><span class="va">quercus_memory</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting_started_files/figure-html/compute-memory-autocor-1.png" class="r-plt" alt="" width="100%"></p>
<p>The plot shows all ecological memory components of this dataset.</p>
<ul>
<li><p><strong>Endogenous memory</strong> (“quercus” curve): shows the
importance of the past pollen abundance in predicting current pollen
abundance. In this case, this is the most important memory component,
with a lag of ~5000 years.</p></li>
<li><p><strong>Significance test</strong> (“random” curve): shows the
median importance scores of randomly generated variables. Defines a
baseline helpful to know when a given memory component explains the
response better (above the yellow line) or worse than random.</p></li>
<li><p><strong>Concurrent effect</strong> (“temp” and “rain” at lag 0):
importance of the current driver values to predict the response. In this
case, the <em>concurrent effect</em> is much weaker than the
<em>endogenous memory</em>.</p></li>
<li><p><strong>Exogenous memory</strong> (“temp” and “rain” at lag &gt;
0): importance of the past driver values in explaining the current
response values. According to the plot, temperature is the strongest
component of the exogenous memory, with a lag of almost ~4000
years.</p></li>
</ul>
<p>The <code><a href="../reference/extractMemoryFeatures.html">extractMemoryFeatures()</a></code> function transforms the plot
results into quantitative features:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extractMemoryFeatures.html">extractMemoryFeatures</a></span><span class="op">(</span></span>
<span>  memory.pattern <span class="op">=</span> <span class="va">quercus_memory</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 1</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; $ label                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "quercus"</span></span>
<span><span class="co">#&gt; $ strength.endogenous  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 24.35066</span></span>
<span><span class="co">#&gt; $ strength.exogenous   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.351078</span></span>
<span><span class="co">#&gt; $ strength.concurrent  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5.653404</span></span>
<span><span class="co">#&gt; $ length.endogenous    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.4</span></span>
<span><span class="co">#&gt; $ length.exogenous     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3</span></span>
<span><span class="co">#&gt; $ dominance.endogenous <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.4</span></span>
<span><span class="co">#&gt; $ dominance.exogenous  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0</span></span></code></pre></div>
<p>The output contains eight features organized in three groups:</p>
<p>The <strong>strength</strong> values (scaled to [0, 1] by default)
measure the peak importance of each memory component relative to the
median of the random baseline.</p>
<p>The <strong>length</strong> values (proportion in [0, 1]) measure how
far into the past each memory component remains above the random
baseline. In this case, the endogenous memory component is above the
baseline for half of the lags.</p>
<p>The <strong>dominance</strong> values (proportion in [0, 1]) measure
whether endogenous or exogenous memory prevails across significant lags.
In this case, the exogenous memory is never above the endogenous one,
hence it has zero dominance.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>The complete workflow:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/alignTimeSeries.html">alignTimeSeries()</a></code> - Align datasets with different
resolutions.</li>
<li>
<code><a href="../reference/lagTimeSeries.html">lagTimeSeries()</a></code> - Create lag structure.</li>
<li>
<code><a href="../reference/computeMemory.html">computeMemory()</a></code> - Fit Random Forest and compute
importance.</li>
<li>
<code><a href="../reference/plotMemory.html">plotMemory()</a></code> - Visualize the memory pattern.</li>
<li>
<code><a href="../reference/extractMemoryFeatures.html">extractMemoryFeatures()</a></code> - Quantify memory
characteristics.</li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://blasbenito.com" class="external-link">Blas M. Benito</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
